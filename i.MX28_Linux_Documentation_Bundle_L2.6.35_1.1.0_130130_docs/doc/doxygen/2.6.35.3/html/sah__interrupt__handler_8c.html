<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MXC Linux BSP: linux/drivers/mxc/security/sahara2/sah_interrupt_handler.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>linux/drivers/mxc/security/sahara2/sah_interrupt_handler.c File Reference</h1>Provides a hardware interrupt handling mechanism for device driver.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static irqreturn_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sah__interrupt__handler_8c.html#2af68ffa81b188584edf3f286901b6c5">sah_Intr_Top_Half</a> (int irq, void *dev_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sah__interrupt__handler_8c.html#3469a32bc571f8f7d673754bac07568a">sah_Intr_Bottom_Half</a> (unsigned long reset_flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sah__interrupt__handler_8c.html#665f6d237e01b64ccde7b11c3cd93e2a">sah_Intr_Init</a> (wait_queue_head_t *wait_queue)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sah__interrupt__handler_8c.html#a05501e1c223e4b0ed0964e2d7f3b675">sah_Intr_Release</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sah__interrupt__handler_8c.html#1761c7b24310991d13fee7e14f82f062">interrupt_count</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">wait_queue_head_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="sah__interrupt__handler_8c.html#899c56940d31bbc2f6857fa69899ac29">int_queue</a> = NULL</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Provides a hardware interrupt handling mechanism for device driver. 
<p>
This file needs to be ported for a non-Linux OS.<p>
It gets a call at <a class="el" href="sah__interrupt__handler_8c.html#665f6d237e01b64ccde7b11c3cd93e2a" title="SAHARA Interrupt Handler Initialisation.">sah_Intr_Init()</a> during initialization.<p>
<a class="el" href="sah__interrupt__handler_8c.html#2af68ffa81b188584edf3f286901b6c5" title="SAHARA Interrupt Handler Top Half.">sah_Intr_Top_Half()</a> is intended to be the Interrupt Service Routine. It calls a portable function in another file to process the Sahara status.<p>
<a class="el" href="sah__interrupt__handler_8c.html#3469a32bc571f8f7d673754bac07568a" title="SAHARA Interrupt Handler Bottom Half.">sah_Intr_Bottom_Half()</a> is a 'background' task scheduled by the top half to take care of the expensive tasks of the interrupt processing.<p>
The driver shutdown code calls <a class="el" href="sah__interrupt__handler_8c.html#a05501e1c223e4b0ed0964e2d7f3b675" title="SAHARA Interrupt Handler Release.">sah_Intr_Release()</a>. <hr><h2>Function Documentation</h2>
<a class="anchor" name="3469a32bc571f8f7d673754bac07568a"></a><!-- doxytag: member="sah_interrupt_handler.c::sah_Intr_Bottom_Half" ref="3469a32bc571f8f7d673754bac07568a" args="(unsigned long reset_flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void sah_Intr_Bottom_Half           </td>
          <td>(</td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>reset_flag</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
SAHARA Interrupt Handler Bottom Half. 
<p>
This function is the Bottom Half of the interrupt handler. It calls <a class="el" href="sah__queue__manager_8c.html#0958b06bd3ab1489a96b709307f75d43">sah_postprocess_queue()</a> to complete the processing of the Descriptor Chains which were finished by the hardware.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Part of the kernel prototype.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

<p>References <a class="el" href="sah__queue__manager_8c-source.html#l00459">sah_postprocess_queue()</a>.</p>

</div>
</div><p>
<a class="anchor" name="665f6d237e01b64ccde7b11c3cd93e2a"></a><!-- doxytag: member="sah_interrupt_handler.c::sah_Intr_Init" ref="665f6d237e01b64ccde7b11c3cd93e2a" args="(wait_queue_head_t *wait_queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sah_Intr_Init           </td>
          <td>(</td>
          <td class="paramtype">wait_queue_head_t *&nbsp;</td>
          <td class="paramname"> <em>wait_queue</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
SAHARA Interrupt Handler Initialisation. 
<p>
This function registers the Top Half of the interrupt handler with the Kernel and the SAHARA IRQ number.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>wait_queue</em>&nbsp;</td><td>Pointer to the wait queue used by driver interface</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>int A return of Zero indicates successful initialisation. </dd></dl>

<p>References <a class="el" href="sah__interrupt__handler_8c-source.html#l00175">sah_Intr_Top_Half()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a05501e1c223e4b0ed0964e2d7f3b675"></a><!-- doxytag: member="sah_interrupt_handler.c::sah_Intr_Release" ref="a05501e1c223e4b0ed0964e2d7f3b675" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sah_Intr_Release           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
SAHARA Interrupt Handler Release. 
<p>
This function releases the Top Half of the interrupt handler. The driver will not receive any more interrupts after calling this functions.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>void </dd></dl>

</div>
</div><p>
<a class="anchor" name="2af68ffa81b188584edf3f286901b6c5"></a><!-- doxytag: member="sah_interrupt_handler.c::sah_Intr_Top_Half" ref="2af68ffa81b188584edf3f286901b6c5" args="(int irq, void *dev_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static irqreturn_t sah_Intr_Top_Half           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>irq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dev_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
SAHARA Interrupt Handler Top Half. 
<p>
This function is the Top Half of the interrupt handler. It updates the status of any finished descriptor chains and then tries to add any pending requests into the hardware. It then queues the bottom half to complete operations on the finished chains.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>irq</em>&nbsp;</td><td>Part of the kernel prototype. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dev_id</em>&nbsp;</td><td>Part of the kernel prototype.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>An IRQ_RETVAL() -- non-zero to that function means 'handled' </dd></dl>

<p>References <a class="el" href="sah__interrupt__handler_8c-source.html#l00055">interrupt_count</a>, <a class="el" href="sah__status__manager_8c-source.html#l00088">sah_Handle_Interrupt()</a>, and <a class="el" href="sah__hardware__interface_8c-source.html#l00404">sah_HW_Read_Status()</a>.</p>

<p>Referenced by <a class="el" href="sah__interrupt__handler_8c-source.html#l00101">sah_Intr_Init()</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="899c56940d31bbc2f6857fa69899ac29"></a><!-- doxytag: member="sah_interrupt_handler.c::int_queue" ref="899c56940d31bbc2f6857fa69899ac29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wait_queue_head_t* <a class="el" href="sah__queue__manager_8c.html#899c56940d31bbc2f6857fa69899ac29">int_queue</a> = NULL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This is set by the Initialisation function 
<p>Referenced by <a class="el" href="sah__queue__manager_8c-source.html#l00415">sah_process_finished_request()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1761c7b24310991d13fee7e14f82f062"></a><!-- doxytag: member="sah_interrupt_handler.c::interrupt_count" ref="1761c7b24310991d13fee7e14f82f062" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="sah__interrupt__handler_8c.html#1761c7b24310991d13fee7e14f82f062">interrupt_count</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of interrupts received. This value should only be updated during interrupt processing. 
<p>Referenced by <a class="el" href="sah__interrupt__handler_8c-source.html#l00175">sah_Intr_Top_Half()</a>.</p>

</div>
</div><p>
</div>
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<Title>footer</Title>
</HEAD>
<BODY>
</ul>
</ul>
</ul>
</ul>
<hr size="1">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1">
  <tr>
    <td width="50%"><small>©&nbsp; Freescale Semiconductor, Inc., 2007.&nbsp; 
    All rights reserved.<br>
    </small><FONT COLOR="#FF0000"><small>Freescale Confidential Proprietary<br>
    </small></FONT><small><FONT COLOR="#FF0000">NDA Required</FONT></small></td>
    <td width="50%"><small>
<a href="http://www.doxygen.org/index.html">
<img src="Freescale25.png" alt="doxygen" align="right" border="0" width="129" height="48"></a></small></td>
  </tr>
</table>
<address style="align: right;">&nbsp;</address>
</body>
</html>
