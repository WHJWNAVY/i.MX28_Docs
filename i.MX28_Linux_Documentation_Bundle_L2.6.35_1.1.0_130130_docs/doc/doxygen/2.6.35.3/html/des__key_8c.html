<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MXC Linux BSP: linux/drivers/mxc/security/rng/des_key.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>linux/drivers/mxc/security/rng/des_key.c File Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="des__key_8c.html#e3b1d0b868383bb35ce987e1a4654c07">fsl_shw_permute1_bytes</a> (const uint8_t *key, uint8_t *permuted_key, int key_count)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="des__key_8c.html#40bae5c15ef73b53265a8b43ff08ef42">pc1</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="des__key_8c.html#5fa73b2ce0e547de714fd6401935fa30">bytebit</a> []</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This file implements the function <a class="el" href="des__key_8c.html#e3b1d0b868383bb35ce987e1a4654c07">fsl_shw_permute1_bytes()</a>.<p>
The code was lifted from crypto++ v5.5.2, which is public domain code. The code to handle words instead of bytes was extensively modified from the byte version and then converted to handle one to three keys at once. <hr><h2>Function Documentation</h2>
<a class="anchor" name="e3b1d0b868383bb35ce987e1a4654c07"></a><!-- doxytag: member="des_key.c::fsl_shw_permute1_bytes" ref="e3b1d0b868383bb35ce987e1a4654c07" args="(const uint8_t *key, uint8_t *permuted_key, int key_count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fsl_shw_permute1_bytes           </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>permuted_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>key_count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert a 3-key 3DES key into the first-permutation 168-bit version.<p>
This is the format of the input key:<p>
<div class="fragment"><pre class="fragment">
   BIT:  |191                                 128|127                                  64|63                                    0|
   BYTE: |  0 |  1 |  2 |  3 |  4 |  5 |  6 |  7 |  8 |  9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23 |
   KEY:  |                   0                   |                   1                   |                   2                   |
  </pre></div><p>
This is the format of the output key:<p>
<div class="fragment"><pre class="fragment">
   BIT:  |167                            112|111                             56|55                               0|
   BYTE: |  0 |  1 |  2 |  3 |  4 |  5 |  6 |  7 |  8 |  9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 |
   KEY:  |                 1                |                 2                |                 3                |
  </pre></div><p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>bytes of 3DES key </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>permuted_key</em>&nbsp;</td><td>21 bytes of permuted key </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key_count</em>&nbsp;</td><td>How many DES keys (2 or 3) </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="5fa73b2ce0e547de714fd6401935fa30"></a><!-- doxytag: member="des_key.c::bytebit" ref="5fa73b2ce0e547de714fd6401935fa30" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="des__key_8c.html#5fa73b2ce0e547de714fd6401935fa30">bytebit</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        0x80, 0x40, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01
}
</pre></div>bit 0 is left-most in byte 
</div>
</div><p>
<a class="anchor" name="40bae5c15ef73b53265a8b43ff08ef42"></a><!-- doxytag: member="des_key.c::pc1" ref="40bae5c15ef73b53265a8b43ff08ef42" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t <a class="el" href="des__key_8c.html#40bae5c15ef73b53265a8b43ff08ef42">pc1</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
        56, 48, 40, 32, 24, 16, 8,
        0, 57, 49, 41, 33, 25, 17,
        9, 1, 58, 50, 42, 34, 26,
        18, 10, 2, 59, 51, 43, 35,
        62, 54, 46, 38, 30, 22, 14,
        6, 61, 53, 45, 37, 29, 21,
        13, 5, 60, 52, 44, 36, 28,
        20, 12, 4, 27, 19, 11, 3,
}
</pre></div>permuted choice table (key)<p>
Note that this table has had one subtracted from each element so that the code doesn't have to do it. 
</div>
</div><p>
</div>
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<Title>footer</Title>
</HEAD>
<BODY>
</ul>
</ul>
</ul>
</ul>
<hr size="1">
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1">
  <tr>
    <td width="50%"><small>©&nbsp; Freescale Semiconductor, Inc., 2007.&nbsp; 
    All rights reserved.<br>
    </small><FONT COLOR="#FF0000"><small>Freescale Confidential Proprietary<br>
    </small></FONT><small><FONT COLOR="#FF0000">NDA Required</FONT></small></td>
    <td width="50%"><small>
<a href="http://www.doxygen.org/index.html">
<img src="Freescale25.png" alt="doxygen" align="right" border="0" width="129" height="48"></a></small></td>
  </tr>
</table>
<address style="align: right;">&nbsp;</address>
</body>
</html>
